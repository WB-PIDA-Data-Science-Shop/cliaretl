% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/api_data360_funs.R
\name{extract_data_from_api}
\alias{extract_data_from_api}
\title{Extract Data from World Bank APIs (Data360 or EFI)}
\usage{
extract_data_from_api(dataset_id, indicator_ids, source, verbose = FALSE)
}
\arguments{
\item{dataset_id}{A character string specifying the dataset ID (e.g., \code{"WDI"}).}

\item{indicator_ids}{A character vector of indicator IDs to retrieve (e.g., \code{c("NY.GDP.MKTP.CD")}).}

\item{source}{A character string indicating the API source.
Must be one of \code{"d360"} or \code{"efi"}.}

\item{verbose}{Logical; if \code{TRUE}, prints detailed request information
(including URLs and raw responses for each request).}
}
\value{
A list of length two:
\describe{
  \item{\code{"SUCCESS"}}{A data frame containing all requested indicator data.}
  \item{\code{"ERROR"}}{An empty data frame if any API request fails.}
}
}
\description{
This function retrieves indicator-level data from either the World Bank Data360 API
or the EFI (Enterprise Surveys/EFI Data Catalog) API. It automatically handles pagination
for large datasets (over 1000 records) by fetching data in chunks and combining the
results into a single data frame.
}
\details{
- The function constructs a query URL based on the provided `dataset_id`, `indicator_ids`,
  and `source` parameters.
- For `source = "d360"`, the function queries the Data360 API endpoint.
- For `source = "efi"`, it queries the EFI Data Catalog API endpoint.
- If the total number of records exceeds 1000, the function iteratively fetches
  data in batches of 1000 records until all data is retrieved.
- If any API call fails (status code != 200), the function returns an error result.
}
\section{Error Handling}{

- If the initial request fails, an "ERROR" result is returned along with an empty data frame.
- If a chunked request (pagination) fails, the function stops and returns "ERROR".
}

\examples{
\dontrun{
# Example: Retrieve GDP data from the WDI dataset using the Data360 API
result <- Extract_data_from_API(
  dataset_id = "WDI",
  indicator_ids = c("NY.GDP.MKTP.CD"),
  source = "d360",
  verbose = TRUE
)

if (result[[1]] == "SUCCESS") {
  head(result[[2]])
}
}

}
\seealso{
\itemize{
  \item{\code{\link[httr]{GET}} for HTTP GET requests.}
  \item{\code{\link[dplyr]{bind_rows}} for combining the paginated results.}
}
}
